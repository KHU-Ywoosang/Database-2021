
### 데이터베이스란? 

데이터베이스 : 조직체의 응용 시스템들이 공유해서 사용하는 운영 데이터들이 구조적으로 통합된 모임

키워드 : 
- 공유 (일부는 공유되는 데이터) 
- 통합 (운영 데이터들을 통합해서 저장)
- 구조적 (관계적 또는 객체지향 데이터 모델)

대규모 데이터 저장소로서 여러 부서에 속하는 여러 사용자에 의해 동시에 사용됨  

### 데이터베이스 스키마와 데이터베이스 상태

데이터베이스 스키마 : 전체적인 데이터베이스 구조  
- 자주 변경되지는 않음
- 데이터베이스의 모든 가능한 상태를 미리 정의한것
- 내포(intension) 라고 부름  

데이터베이스 상태 : 특정 시점의 데이터베이스 내용

- 시간이 지남에 따라 계속해서 바뀜
- 외연(extention) 라고 부름

### DBMS 

DBMS(Database management system) : 데이터베이스 관리 시스템

- 소프트웨어 패키지  
- 데이터베이스 구조를 명시
- 효율적인 데이터 질의어를 지원
- 데이터를 안전하게 보호  
- 여러 사용자가 데이터베이스를 접근하는 것 제어  

### 컴퓨터 시스템에서 DBMS

DBMS : 운영체제와 응용프로그램 사이에 위치

하드웨어 : 데이터베이스는 디스크와 같은 보조 기억 장치에 저장  

DBMS 에서 원하는 정보를 찾기 위해서는 디스크의 블록들을 주기억 장치로 읽어들어야함  
계산이나 비교 연산들을 수행하기 위해 중앙 처리 장치(CPU) 사용  
  
SQL : 여러 DBMS 에서 사용


### 데이터베이스 시스템의 요구사항

- 데이터 독립성
- 데이터에 대한 여러 사용자의 동시접근
- 백업과 회복
- 중복을 줄이거나 제어하며 일관성 유지
- 데이터 무결성
- 권한이 없는 사용자로부터 데이터베이스를 보호
- 질의어 지원


부팅 => 바이오스가 제일 먼저 켜짐 => 


### 기존 화일 시스템의 문제점 

- 화일 접근 방식이 응용프로그램내 상세하게 표현되므로 데이터에 대한 응용 프로그램의 의존도가 높음
- 데이터가 많은 화일에 중복해서 저장되기 때문에 필드 값이 바뀔 때 화일들을 모두 수정하지 않으면 데이터의 불일치가 발생

### DBMS 장점

- 중복과 불일치가 감소
- 시스템을 개발하고 유지하는 비용이 감소
- 표준화를 시행하기가 용이
- 보안이 향상
- 무결성이 향상
- 데이터베이스의 공유와 동시 접근이 가능
- 다양한 유형의 고장으로부터 데이터베이스를 회복 가능


### DBMS 선정시 고려사항

기술적 요인
- DBMS 에 사용되고 있는 데이터 모델 (관계,객체), DBMS 가 지원하는 사용자 인터페이스, 프로그래밍 언어, 응용 개발 도구, 저장 구조, 성능, 접근 방법 등

경제적 요인
- 소프트웨어와 하드웨어 구입 비용, 유지 보수 비용, 직원들의 교육 지원 등


## 데이터 모델

- 데이터베이스의 구조를 기술하는데 사용되는 개념들의 집합 구조(데이터 타입과 관계)  
이 구조 위에서 동작하는 연산자들, 무결성 제약조건들  
- 사용자에게 내부 저장 방식의 세세한 사항은 숨기면서 데이터에 대한 직관적인 뷰 제공과 동시에 이들간의 매핑 제공  

## 데이터 모델의 분류

- 고수준 또는 개념적 데이터 모델(conceptual data model)
  * 엔티티-관계 (Entitiy-Relationship)
- 표현(구현) 데이터 모델
  * 계층 데이터 모델(hierachical data model)
  * 네트워크 데이터 모델(network data model)
  * 관계 데이터 모델(relational data model)

## DBMS 언어

데이터 정의어(DDL : Data Definition Language)
- 사용자는 데이터 정의어를 사용하여 데이터베이스 스키마를 정의
- 데이터 정의어로 명시된 문장이 입력되면 DBMS는 사용자가 정의한 스키마에 대한 명세를 시스템 카탈로그 또는 데이터 사전에 저장
- 데이터 정의어의 기본적인 기능
  * 데이터 구조를 생성 : CREATE TABLE
  * 데이터 구조의 변경 : ALTER TABLE
  * 데이터 구조의 삭제 : DROP TABLE
  * 데이터 접근을 위해 특정 애트리뷰트 위에 인덱스를 정의 : CREATE INDEX 
데이터 조작어(DML : Data Manuplation Language)
- 데이터 검색,수정,삽입,삭제
- 절차적 언어와 비절차적 언어(원하는 데이터가 무엇인지만)
- SQL 은 대표적 비절차적 언어
- 대부분 데이터 조작어는 SUM,COUNT,AVG 와 같은 내장 함수들을 갖고 있음
- 데이터 조작어는 단말기에서 대화식으로 입력되어 수행되거나 JAVA 등 응용프로그램 내에서 사용됨

관계형 DBMS : 데이터 베이스 테이블의 키값(식별자) 을 참조

계층형 :  포인터,링크로 데이터 연결 

## DBMS 사용자

데이터베이스 관리자 (DBA: Database Administrator)  
- 조직의 여러 부분의 상이한 요구를 만족시키기 위해 일관성 있는 데이터베이스 스키마를 생성하고 유지
- 데이터베이스 관리자의 역할  
  * 데이터베이스 스키마 생성과 변경
  * 무결성 제약조건을 명시
  * 사용자 권한을 허용하거나 취소하고, 사용자 역할을 관리
  * 저장 구조와 접근방법(물리적 트랜젝션) 정의
  
응용 프로그래머
- 데이터베이스 위에서 특정 응용(고객관리,인사관리,재고관리 등) 이나 인터페이스 구현  
- 고급 프로그래밍 언어인 JAVA 등으로 



최종 사용자 (end user)
- 질의하거나 갱신하거나 보고서를 생성하기 위해서 데이터베이스를 사용하는 사람
- 캐주얼 사용자와 기작전 트랜지션(canned transaction)을 주로 반복해서 수행하는 초보 사용자로 구분  

기작전 트랜지션: 사용자가 추가적으로 뭘 개발하거나 할 필요 없이 바로 쓸 수 있는 

데이터베이스 설계자


- ERWin 등의 CASE 도구들을 이용해 데이터베이스 설계를 담당
- 데이터베이스의 일관성을 위지하기 위해서 정규화를 수행
오퍼레이터  


오퍼레이터 : 컴퓨터시스템,전산실 관리
데이터베이스 설계자 


각각의 DBMS 는 각각의 API 사용 => 표준 API 하나로 통함 (ODBC)
자바는 JDBC(java database connectivity) : 자바프로그램을 사용해서 DBMS 사용하는 프로그램을 사용할때 
DBMS 제품이 바뀌더라도 응용프로그램 바꾸지 않고 사용 가능 
bridge : 연결되지 않은 것을 연결시키는 역할 : DBAS 

DBMS A => ODBC
DBMS B => JDBC 
A 와 B 연결하고 싶으면 bridge 사용 
데이터가 한 쪽에서 다른쪽으로 가는 것을 허용
클라이언트-서버 데이터베이스 시스템
클라이언트-서버 환경에서 대표적인 응용프로그램의 예 : POS 기 웹 화면 

응용 논리 (2,3 계층 ) : application logic 또는 business logic 
편의점 갈 때 1+1 이벤트 같은것 : 프로그램 안에서 구현
항공기 예약 시스템 : 클라이언트 - 사용자 로그인, 알아보기 쉬운 형식으로 결과 출력
응용서버 : 새로운 예약받기,기존예약 취소
데이터베이스 서버 : 


3층모델 응용서버에만 프로그램~ 용이


내부단계 :조직체 전체 
외부단계 : 개별적 사용자의 뷰 


## 관계 데이터 모델과 제약조건

## 관계 데이터 모델과 제약조건

- 여전히 가장 널리 사용되는 DBMS 임
- 관계 데이터 모델을 최초로 구현한 가장 중요한 관계 DBMS 시제품은 System R
- 1970 년대에 E.F.Codd 가 제안 

관계 데이터 모델이 큰 성공을 거둔 요인 
- 간단한 테이블(Relation) 이용
- 중첩된 복잡한 구조가 없음 
- 다른 데이터 모델에 비해 이론이 잘 정립
- 관계 데이터베이스 설계와 효율적인 질의 처리 면에서 뛰어난 장점을 가짐
- 실무에서 표준 데이터베이스 응용에 대해 좋은 성능을 보임
- 숙련되지 않은 사용자도 쉽게 이해할 수 있음

## 관계 데이터 모델
- 동일한 구조(Relation) 의 관점에서 모든 데이터를 논리적으로 구성
  * 논리적으로 연관된 데이터를 연결하기 위해 링크나 포인터를 사용하지 않음
- 선언적인 질의어를 통한 데이터 접근을 제공
  * 사용자는 원하는 데이터(what)만 명시하고, 어떻게 이 데이터를 찾을
것인가(how)는 명시할 필요가 없음
  *  응용 프로그램들은 데이터베이스 내의 레코드들의 어떠한 순서와도 무관하게
작성됨

## 기본적인 용어
-릴레이션(relation): 2차원의 테이블(스프레드 시트와 유사)
- 레코드(record): 릴레이션의 각 행
- 투플(tuple): 레코드를 좀더 공식적으로 부르는 용어. 특별한 말이 없으면 레코드와 동일
- 애트리뷰트(attribute): 릴레이션에서 이름을 가진 하나의 열

## 도메인(domain)

- 한 애트리뷰트에 나타날 수 있는 값들의 집합
- 각 애트리뷰트의 도메인의 값들은 정수,문자열등의 원자값
- 프로그래밍 언어의 데이터타입과 유사 
- 동일한 도메인이 여러 애트리뷰트에서 사용될 수 있음
- 복잡한 애트리뷰는 허용되지 않음

## 


 차수: 한 릴레이션에 들어 있는 애트리뷰트들의 수
 유효한 릴레이션의 최소 차수는 1
 릴레이션의 차수는 자주 바뀌지 않음
   스키마가 수정될때만 바뀜 

카디날리티: 릴레이션의 투플 수
 유효한 릴레이션은 카디날리티 0을 가질 수 있음
 릴레이션의 카디날리티는 투플의 삽입과 삭제에따라 계속해서 변함 

|제목|내용|설명|
|------|---|---|
|테스트1|테스트2|테스트3|
|테스트1|테스트2|테스트3|
|테스트1|테스트2|테스트3|

## null 값 

- 알려지지 않음 또는 적용할 수 없음을 나타내기 위해 널값을
사용
- 예: 사원 릴레이션에 새로운 사원에 관한 투플을 입력하는데, 신입
사원의 DNO(부서번호)가 결정되지 않았을 수 있음 사원이므로 DB에는 넣어야하고 부서번호는 부여할 수 없을 때 
- 널값은 숫자 도메인의 0이나 문자열 도메인의 공백 문자 또는 공백
문자열과 다름
- DBMS들마다 널값을 나타내기 위해 서로 다른 기호를 사용함

## 스키마(relation schema) 

차수와 관련 
- 릴레이션의 이름과 릴레이션의 애트리뷰트들의 집합
- 릴레이션을 위한 틀(framework)
- 표기법 
  * 릴레이션이름(애트리뷰트1, 애트리뷰트2, ... 애트리뷰트N)
  * 스키마는 애트리뷰트들의 집합 
  * 기본 키 애트리뷰트에는 밑줄 표시
  * 내포(intension)라고 함


## 릴레이션 인스턴스(relation instance) 

카디날리티 
- 릴레이션에 어느 시점에 들어 있는 투플들의 집합
- 시간의 흐름에 따라 계속 변함
- 일반적으로 릴레이션에는 현재의 인스턴스만 저장됨
- 외연(extension)이라고 함

## 관계 데이터베이스(relational database) 스키마
- 하나 이상의 릴레이션 스키마들로 이루어짐

## 관계 데이터베이스 인스턴스
- 릴레이션 인스턴스들의 모임으로 구성됨


empty string = '' 은 '' 라는 값이 있는 것
null 과는 다름
이걸 정확히 구분하기 위해 null 

## Relation 의 특성

- 릴레이션
  * 투플들의 집합
- 릴레이션의 특성
  * 각 릴레이션은 오직 하나의 레코드 타입만 포함
  * 한 애트리뷰트 내의 값들은
모두 같은 유형
  * 애트리뷰트들의 순서는
중요하지 않음


## 릴레이션의 특성(계속)

- 동일한 투플이 두 개 이상 존재하지 않음
  * 키가 존재함
-  한 투플의 각 애트리뷰트는 원자값을 가짐
릴레이션의 특성(계속)
-  각 애트리뷰트의 이름은 한 릴레이션 내에서만 고유
-  투플들의 순서는 중요하지 않음


## 릴레이션의 키 

- 각 투플을 고유하게 식별할 수 있는 하나 이상의 애트리뷰트들의 모임
- 수퍼 키(superkey), 후보 키(candidate key), 기본 키(primary key), 대체
키(alternate key), 외래 키(foreign key) 

##  수퍼 키 (superkey)

 한 릴레이션 내의 특정 투플을 고유하게 식별하는 하나의 애트리뷰트 또는
애트리뷰트들의 집합
 예: 신용카드 회사의 고객 릴레이션에서 (신용카드번호, 주소) 또는
(주민등록번호, 이름) 또는 (주민등록번호)
 투플들을 고유하게 식별하는데 꼭 필요하지 않은 애트리뷰트들을 포함할
수 있음

##  후보 키 (candidate key)
 각 투플을 고유하게 식별하는 최소한의 애트리뷰트들의 모임
예: (신용카드번호, 주소)는 신용카드 회사의 고객 릴레이션의
후보 키가 아니지만 (신용카드번호)는 후보 키
 모든 릴레이션에는 최소한 한 개 이상의 후보 키가 있음
 후보 키도 두 개 이상의 애트리뷰트로 이루어질 수 있으며 이런 경우에
복합 키(composite key)라고 부름
예: (학번, 과목번호)가 후보 키


## 기본 키 (primary key)
 한 릴레이션에 후보 키가 두 개 이상 있으면 설계자 또는 데이터베이스
관리자가 이들 중에서 하나를 기본 키로 선정함
예: 신용카드 회사의 고객 릴레이션에서 신용카드번호와 주민등록번호가
후보 키가 될 수 있음. 이 중에서 신용카드 번호를 기본 키로 선정
 자연스러운 기본 키를 찾을 수 없는 경우에는 레코드 번호와 같이 종종
인위적인 키 애트리뷰트를 릴레이션에 추가할 수 있음

## 대체 키 (alternate key)
 기본 키가 아닌 후보 키
예: 신용카드 회사의 고객 릴레이션에서 신용카드번호를 기본 키로
선정하면 주민등록번호는 대체 키


## 외래 키 (foreign key)


 어떤 릴레이션의 기본 키(primary key) 를 참조하는 애트리뷰트
 관계 데이터베이스에서 릴레이션들 간의 관계를 나타내기 위해서 사용됨
 외래 키 애트리뷰트는 참조되는 릴레이션의 기본 키와 동일한 도메인을
가져야 함
 자신이 속한 릴레이션의 기본 키의 구성요소가 되거나 되지 않을 수 있음

- 다른 릴레이션의 기본 키를 참조하는 외래 키 
- 자체 릴레이션의 기본 키를 참조하는 외래 키 
- 기본 키의 구성요소가 되는 외래 키 

## 무결성 제약조건 

데이터 무결성(data integrity)
 데이터의 정확성 또는 유효성을 의미
 일관된 데이터베이스 상태를 정의하는 규칙들을 묵시적으로 또는
명시적으로 정의함
 데이터베이스가 갱신될 때 DBMS가 자동적으로 일관성 조건을 검사하므로
응용 프로그램들은 일관성 조건을 검사할 필요가 없음

도메인 제약조건(domain constraint)
- 각 DBMS 의 기본조건이므로 묵시적으로 적용된다 
 각 애트리뷰트 값이 반드시 원자값이어야 함
 애트리뷰트 값의 디폴트 값, 가능한 값들의 범위 등을 지정할 수 있음
 데이터 형식을 통해 값들의 유형을 제한하고, CHECK 제약 조건을 통해
값들의 범위를 제한할 수 있음
 SQL2는 도메인을 명시적으로 정의하는 것을 허용하지만,
오라클은 지원하지 않음



기본 키와 엔티티 무결성 제약조건(entity integrity constraint)
 기본 키가 각 투플들을 식별하기 위하여 사용되기 때문에 릴레이션의 기본
키를 구성하는 어떤 애트리뷰트도 널값을 가질 수 없다는 제약조건
 대체 키에는 적용되지 않음
- 기본키에만 적용. 널값을 가지지 않는 애트리뷰트여야 함 
 사용자는 릴레이션을 생성하는 데이터 정의문에서 어떤 애트리뷰트가
릴레이션의 기본 키의 구성요소인가를 DBMS에게 알려줌


참조되는 릴레이션에는 새로운 츄플이 삽입되어도 참조무결성 제약조건 제약 X

참조하는 릴레이션에 새로운 투플을 삽입할 때는 도메인 제약조건, 키
제약조건, 엔티티 무결성 제약조건 외에 참조 무결성 제약조건도 위배할 수
있음
- : EMPLOYEE 릴레이션에 (4325, 오혜원, 6)이라는 투플을 삽입하면 참조
무결성 제약조건을 위배하게 됨 (6번 부서가 없기 때문 )




삭제 
참조하는 릴레이션에서 투플이 삭제되면 도메인 제약조건, 키 제약조건,
엔티티 무결성 제약조건, 참조 무결성 제약조건 등 모든 제약조건을
위배하지 않음
 참조되는 릴레이션에서 투플이 삭제되면 참조 무결성 제약조건을 위배하는
경우가 생기거나 생기지 않을 수 있음




참조 무결성 제약조건을 만족시키기 위해서 DBMS가 제공하는
옵션(계속)
 널값(nullify)
 참조되는 릴레이션에서 투플을 삭제하고, 참조하는 릴레이션에서 이 투플을
참조하는 투플들의 외래 키에 널값을 삽입
 예: DEPARTMENT 릴레이션에서 (3, 개발, 9)를 삭제하면 EMPLOYEE
릴레이션에서 부서번호 3을 참조하는 두 번째 투플과 다섯 번째 투플의
부서번호에 널값을 삽입

삭제하는 대신에 null 값 넣음 


기본적으로  null 이 디폴드 값 


디폴트값
 널값을 넣는 대신에 디폴트값을 넣는다는 것을 제외하고는 바로 위의 옵션과
비슷함

삭제 옵션 키워드 
ON DELETE { NO ACTION | CASCADE | SET NULL | SET DEFAULT } 
 NO ACTION : 삭제 제한 
CASCADE: 연쇄삭제 
SET NUL: 널값 지젖ㅇ 

수정
 DBMS는 수정하는 애트리뷰트가 기본 키인지 외래 키인지 검사함
 수정하려는 애트리뷰트가 기본 키도 아니고 외래 키도 아니면 수정 연산이
참조 무결성 제약조건을 위배하지 않음
 기본 키나 외래 키를 수정하는 것은 하나의 투플을 삭제하고 새로운 투플을 그 자리에 삽입하는 것과 유사하므로, 삽입 및 삭제에서 설명한 제한, 연쇄, 널값, 디폴트값 규칙이 수정 연산에도 적용됨
 오라클에서는 수정 연산에 대해 제한적으로 참조 무결성 제약조건을 유지 - 기본키는 절대 삭제되서는 안됨 
 기본 키는 변경하면 안된다는 철학